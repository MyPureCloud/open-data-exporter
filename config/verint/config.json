{
  "pureCloud": {
    "clientId": "",
    "clientSecret": "",
    "timeout": 10000
  },
  "queries": {
    "verint_agent_detail_query": {
      "name": "verint_agent Detail Query",
      "type": "conversationAggregate",
      "action": "query",
      "query": {
        "interval": "{{#def.vars.previousInterval}}",
        "groupBy": [
          "userId",
          "queueId"
        ],
        "filter": {
          "type": "and",
          "predicates": [
            {
              "type": "dimension",
              "dimension": "interactionType",
              "operator": "matches",
              "value": "contactCenter"
            }
          ]
        },
        "metrics": [
          "tAnswered",
          "tTalk",
          "tAcw"
        ]
      }
    },
    "verint_agent_scorecard_report_call_query": {
      "name": "verint_agent Scorecard Report - Call Query",
      "type": "conversationAggregate",
      "strategy": "query",
      "query": {
        "interval": "{{#def.vars.currentInterval}}",
        "groupBy": [
          "userId"
        ],
        "filter": {
          "type": "and",
          "predicates": [
            {
              "type": "dimension",
              "dimension": "interactionType",
              "operator": "matches",
              "value": "contactcenter"
            },
            {
              "type": "dimension",
              "dimension": "mediaType",
              "operator": "matches",
              "value": "voice"
            }
          ]
        },
        "metrics": [
          "tTalk",
          "tAcw",
          "tHeld",
          "tHandle"
        ]
      }
    },
    "verint_agent_scorecard_report_user_query": {
      "name": "verint_agent Scorecard Report - User Query",
      "type": "userAggregate",
      "strategy": "query",
      "transforms": {
        "verint_agent_scorecard_report_user_query_transform": { "$ref": "#/transforms/verint_agent_scorecard_report_user_query_transform" }
      },
      "query": {
        "interval": "{{#def.vars.currentInterval}}",
        "groupBy": [
          "userId"
        ],
        "filter": {
          "type": "or",
          "predicates": []
        },
        "metrics": [
          "tAgentRoutingStatus"
        ]
      }
    },
    "verint_agent_scorecard_report_user_query_repeat": {
      "name": "verint_agent Scorecard Report - User Query",
      "type": "userAggregate",
      "strategy": {
        "type": "repeat",
        "collection": "def.data.verint_agent_scorecard_report_call_query.results",
        "destination": "def.data.verint_agent_scorecard_report_user_query.{{=it.group.userId}}"
      },
      "query": {
        "interval": "{{#def.vars.currentInterval}}",
        "groupBy": [
          "userId"
        ],
        "filter": {
          "type": "or",
          "predicates": [
            {
              "type": "dimension",
              "dimension": "userId",
              "operator": "matches",
              "value": "{{=it.group.userId}}"
            }
          ]
        },
        "metrics": [
          "tAgentRoutingStatus"
        ]
      }
    }
  },
  "transforms": {
    "verint_agent_detail_transform": {
      "name": "verint_agent Detail Transform",
      "expressions": []
    },
    "verint_agent_scorecard_report_transform": {
      "name": "verint_agent Scorecard Report Transform",
      "type": "transform",
      "expressions": [
        "{{#def.verint.aggregateVerintData(def.data)}}",
        "{{#def.dataOperations.flattenAggregateData(def.data.verint_agent_scorecard_report_call_query, 'tAgentRoutingStatus_ALL|tTalk|tAcw|tHeld|tHandle|tAgentRoutingStatus_AUX_IN_TIME|tAgentRoutingStatus_COMMUNICATING|tAgentRoutingStatus_IDLE')}}"
      ]
    },
    "verint_agent_scorecard_report_user_query_transform": {
      "name": "verint_agent_scorecard_report_user_query_transform",
      "type": "transform",
      "expressions": [
        "{{#def.verint.populateUserIdPredicates(def.data.verint_agent_scorecard_report_call_query.results, def.vars.query)}}"
      ]
    },
    "write_data": {
      "name": "write_data",
      "type": "transform",
      "expressions": [
        "{{#def.dataOperations.writeData(def.data, '../local/data.json')}}"
      ]
    }
  },
  "templates": {
    "verint_agent_detail_template": {
      "name": "verint_agent detail template",
      "template": "AGENT DETAIL REPORT\n{{#def.datetimeOperations.formatDate(def.vars.currentIntervalStart,'YYYY-MM-DDTHH:mm:ss.SSSZZ')}}\r\n{{~it.data.verint_agent_detail_query.results :result}}{{=result.group.queueId}}|{{=result.group.userId}}|{{=it.getMetric(result.data, 'tAnswered').stats.count}}|{{=it.getMetric(result.data, 'tTalk').stats.max}}|{{=it.getMetric(result.data, 'tAcw').stats.max}}\n{{~}}END AGENT DETAIL REPORT",
      "fileName": "verint_agent_detail_template_{{#def.datetimeOperations.formatDate(def.vars.date,'YYYY_MM_DD_HH.mm.SSS')}}.txt",
      "customData": {
        "templateData": "verint"
      }
    },
    "verint_agent_scorecard_report_template": {
      "name": "verint_agent Scorecard Report template",
      "template": "Verint Report\nDate:{{#def.datetimeOperations.formatDate(def.vars.currentIntervalStart, 'MM/DD/YYYY')}}\nStart Time:{{#def.datetimeOperations.formatDate(def.vars.currentIntervalStart, 'HH:mm')}}\nEnd Time:{{#def.datetimeOperations.formatDate(def.datetimeOperations.addDuration(def.vars.currentIntervalStart, def.vars.interval), 'HH:mm')}}\n\nAGENT_ID DATE STAFF_TIME TALK_TIME ACW_TIME HOLD_TIME AUX_ALL_TIME AUX_IN_TIME AUX_OUT_TIME IDLE_TIME ACDCALLS\n\n{{~it.data.verint_agent_scorecard_report_call_query.results :result}}{{=result.group.userId}} {{=it.datetimeOperations.formatDate(it.datetimeOperations.parseInterval(result.flatData.c0.interval).start, 'YYYY-MM-DD')}} {{=result.flatData.c0.flatMetrics.tAgentRoutingStatus_ALL.stats.sum}} {{=result.flatData.c0.flatMetrics.tTalk.stats.sum}} {{=result.flatData.c0.flatMetrics.tAcw.stats.sum}} {{=result.flatData.c0.flatMetrics.tHeld.stats.sum}} {{=result.flatData.c0.flatMetrics.tHandle.stats.sum}} {{=result.flatData.c0.flatMetrics.tAgentRoutingStatus_AUX_IN_TIME.stats.sum}} {{=result.flatData.c0.flatMetrics.tAgentRoutingStatus_COMMUNICATING.stats.sum}} {{=result.flatData.c0.flatMetrics.tAgentRoutingStatus_IDLE.stats.sum}} {{=result.flatData.c0.flatMetrics.tHandle.stats.count}} \n{{~}}",
      "fileName": "verint_agent_scorecard_report_{{#def.datetimeOperations.formatDate(def.vars.currentIntervalStart,'YYYY_MM_DD_HH.mm')}}.txt"
    }
  },
  "exports": {
    "verint_file_export": {
      "name": "Verint file export",
      "type": "file",
      "destination": "../config/verint/output/",
      "customData": {}
    }
  },
  "configurations": {
    "verint_agent_detail_config": {
      "name": "AGENT DETAIL REPORT",
      "queries": {
        "verint_agent_detail_query": {
          "$ref": "#/queries/verint_agent_detail_query"
        }
      },
      "transforms": {
        "verint_agent_detail_transform": {
          "$ref": "#/transforms/verint_agent_detail_transform"
        }
      },
      "templates": {
        "verint_agent_detail_template": {
          "$ref": "#/templates/verint_agent_detail_template"
        }
      },
      "exports": {
        "verint_file_export": {
          "$ref": "#/exports/verint_file_export"
        }
      },
      "customData": {}
    },
    "verint_agent_scorecard_report_config": {
      "name": "AGENT DETAIL REPORT",
      "externalModules": {
        "verint": "./extensions/verint/verint.js"
      },
      "executionPlan": {
        "verint_agent_scorecard_report_call_query": {
          "$ref": "#/queries/verint_agent_scorecard_report_call_query"
        },
        "verint_agent_scorecard_report_user_query": {
          "$ref": "#/queries/verint_agent_scorecard_report_user_query"
        },
        "verint_agent_scorecard_report_transform": {
          "$ref": "#/transforms/verint_agent_scorecard_report_transform"
        },
        "write_data": {
          "$ref": "#/transforms/write_data"
        }
      },
      "templates": {
        "verint_agent_scorecard_report_template": {
          "$ref": "#/templates/verint_agent_scorecard_report_template"
        }
      },
      "exports": {
        "verint_file_export": {
          "$ref": "#/exports/verint_file_export"
        }
      },
      "customData": {
        "interval": "P1D"
      }
    }
  },
  "jobs": {
    "verint_agent_detail_job": {
      "name": "verint_agent detail job",
      "configurations": {
        "verint_agent_detail_config": {
          "$ref": "#/configurations/verint_agent_detail_config"
        }
      },
      "cron": "10,40 * * * * *",
      "customData": {}
    },
    "verint_agent_scorecard_report_job": {
      "name": "verint_agent Scorecard Report job",
      "configurations": {
        "verint_agent_scorecard_report_config": {
          "$ref": "#/configurations/verint_agent_scorecard_report_config"
        }
      },
      "cron": "10,40 * * * * *",
      "customData": {}
    },
    "verint_all": {
      "name": "Verint all jobs",
      "configurations": {
        "verint_agent_detail_config": {
          "$ref": "#/configurations/verint_agent_detail_config"
        },
        "verint_agent_scorecard_report_config": {
          "$ref": "#/configurations/verint_agent_scorecard_report_config"
        }
      },
      "cron": "10,40 * * * * *",
      "customData": {}
    }
  },
  "customData": {
    "timezoneOverride": "America/Indianapolis"
  }
}